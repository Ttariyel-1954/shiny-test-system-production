# Test Sistemi Shiny TÉ™tbiqi
library(shiny)
library(shinydashboard)

# UI - Ä°stifadÉ™Ã§i Ä°nterfeysi
ui <- dashboardPage(
  
  # Header
  dashboardHeader(title = "Test Sistemi - 600 Ä°stifadÉ™Ã§i"),
  
  # Sidebar
  dashboardSidebar(
    sidebarMenu(
      menuItem("Ana SÉ™hifÉ™", tabName = "home", icon = icon("home")),
      menuItem("Test", tabName = "test", icon = icon("clipboard-list")),
      menuItem("NÉ™ticÉ™lÉ™r", tabName = "results", icon = icon("chart-bar")),
      menuItem("Sistem", tabName = "system", icon = icon("cog"))
    )
  ),
  
  # Body
  dashboardBody(
    tabItems(
      
      # Ana sÉ™hifÉ™
      tabItem(tabName = "home",
        fluidRow(
          # XoÅŸ gÉ™lmisiniz box
          box(
            width = 12,
            title = "ğŸ‰ XoÅŸ GÉ™lmisiniz!", 
            status = "success",
            solidHeader = TRUE,
            height = "400px",
            div(
              style = "text-align: center; padding: 50px;",
              h1("Online Test Sistemi", style = "color: #28a745; margin-bottom: 30px;"),
              h2("20 ÅŸÉ™bÉ™kÉ™ Ã— 30 kompÃ¼ter = 600 istifadÉ™Ã§i", style = "color: #6c757d; margin-bottom: 30px;"),
              br(),
              div(
                style = "background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;",
                h3("ğŸš€ Docker Container HazÄ±rdÄ±r!", style = "color: #007bff;"),
                h4("ğŸ“¦ GitHub-da PaylaÅŸÄ±ma HazÄ±r!", style = "color: #28a745;")
              ),
              br(),
              p("Sistem vaxtÄ±:", strong(textOutput("current_time", inline = TRUE)), 
                style = "font-size: 16px; color: #495057;")
            )
          )
        )
      ),
      
      # Test sÉ™hifÉ™si
      tabItem(tabName = "test",
        fluidRow(
          box(
            width = 8,
            title = "Test SuallarÄ±", 
            status = "primary",
            solidHeader = TRUE,
            h3("Test BÃ¶lmÉ™si"),
            p("Bu bÃ¶lmÉ™dÉ™ test suallarÄ± vÉ™ cavablar olacaq."),
            br(),
            h4("Demo Sual:"),
            div(
              style = "background: #e9ecef; padding: 15px; border-radius: 5px;",
              p(strong("Sual 1:"), "AzÉ™rbaycanÄ±n paytaxtÄ± hansÄ±dÄ±r?"),
              radioButtons("demo_question", "CavabÄ±nÄ±zÄ± seÃ§in:",
                          choices = list(
                            "A) GÉ™ncÉ™" = "A",
                            "B) BakÄ±" = "B", 
                            "C) SumqayÄ±t" = "C",
                            "D) LÉ™nkÉ™ran" = "D"
                          ), selected = character(0)),
              br(),
              actionButton("check_answer", "CavabÄ± Yoxla", 
                          class = "btn-success", style = "margin-right: 10px;"),
              actionButton("next_question", "NÃ¶vbÉ™ti Sual", 
                          class = "btn-primary")
            ),
            br(),
            verbatimTextOutput("answer_result")
          ),
          
          box(
            width = 4,
            title = "Test MÉ™lumatlarÄ±",
            status = "info",
            solidHeader = TRUE,
            h4("Statistika:"),
            p("â€¢ CÉ™mi suallar: 50"),
            p("â€¢ Cavablanan: 1"),
            p("â€¢ DoÄŸru cavablar: 0"),
            p("â€¢ SÉ™hv cavablar: 0"),
            br(),
            progressBar(id = "test_progress", value = 2, title = "Tamamlama: 2%")
          )
        )
      ),
      
      # NÉ™ticÉ™lÉ™r sÉ™hifÉ™si  
      tabItem(tabName = "results",
        fluidRow(
          box(
            width = 12,
            title = "Test NÉ™ticÉ™lÉ™ri",
            status = "warning", 
            solidHeader = TRUE,
            h3("Ãœmumi NÉ™ticÉ™lÉ™r"),
            br(),
            div(
              style = "background: #fff3cd; padding: 15px; border-radius: 5px; border-left: 4px solid #ffc107;",
              h4("ğŸ“Š Sistem StatistikalarÄ±:"),
              p("â€¢ Ãœmumi istifadÉ™Ã§i sayÄ±: 600"),
              p("â€¢ Aktiv testlÉ™r: 0"), 
              p("â€¢ TamamlanmÄ±ÅŸ testlÉ™r: 0"),
              p("â€¢ Orta nÉ™ticÉ™: 0%")
            )
          )
        )
      ),
      
      # Sistem sÉ™hifÉ™si
      tabItem(tabName = "system",
        fluidRow(
          box(
            width = 6,
            title = "Sistem MÉ™lumatlarÄ±",
            status = "info",
            solidHeader = TRUE,
            verbatimTextOutput("system_info")
          ),
          
          box(
            width = 6, 
            title = "Docker MÉ™lumatlarÄ±",
            status = "primary",
            solidHeader = TRUE,
            div(
              h4("ğŸ³ Container Status: âœ… Ä°ÅŸlÉ™yir"),
              p("â€¢ Image: shiny-test-app"),
              p("â€¢ Port: 3838"),
              p("â€¢ Memory: Optimized"),
              p("â€¢ Network: Bridge"),
              br(),
              p(strong("Deploy edilmÉ™ Ã¼Ã§Ã¼n hazÄ±rdÄ±r!"))
            )
          )
        )
      )
      
    )
  )
)

# Server - Backend mÉ™ntiq
server <- function(input, output, session) {
  
  # Cari vaxtÄ± gÃ¶stÉ™r
  output$current_time <- renderText({
    invalidateLater(1000, session) # HÉ™r saniyÉ™ yenilÉ™
    format(Sys.time(), "%Y-%m-%d %H:%M:%S")
  })
  
  # Demo sualÄ±n cavabÄ±nÄ± yoxla
  output$answer_result <- renderText({
    if(input$check_answer > 0) {
      if(isolate(input$demo_question) == "B") {
        "âœ… DoÄŸru! AzÉ™rbaycanÄ±n paytaxtÄ± BakÄ±dÄ±r."
      } else if(isolate(input$demo_question) != "") {
        "âŒ SÉ™hv! DoÄŸru cavab: B) BakÄ±"
      } else {
        "âš ï¸ ZÉ™hmÉ™t olmasa cavab seÃ§in!"
      }
    }
  })
  
  # Sistem mÉ™lumatlarÄ±
  output$system_info <- renderText({
    paste(
      "ğŸ–¥ï¸ Sistem MÉ™lumatlarÄ±:\n",
      "â€¢ R versiyasÄ±:", R.version.string, "\n",
      "â€¢ Shiny versiyasÄ±:", packageVersion("shiny"), "\n", 
      "â€¢ Platform:", R.version$platform, "\n",
      "â€¢ YaddaÅŸ:", round(memory.size(max = TRUE), 1), "MB\n",
      "â€¢ Ä°ÅŸlÉ™mÉ™ mÃ¼ddÉ™ti:", round(as.numeric(Sys.time() - .POSIXct(Sys.Date())), 1), "saat\n",
      "â€¢ Status: ğŸŸ¢ Aktiv"
    )
  })
  
}

# TÉ™tbiqi iÅŸÉ™ sal
shinyApp(ui = ui, server = server)
